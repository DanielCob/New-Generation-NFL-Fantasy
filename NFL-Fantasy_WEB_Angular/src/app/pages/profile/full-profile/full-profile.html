<!--
  full-profile.html
  -----------------------------------------------------------
  Cambios clave:
  - Se reemplazaron listas sueltas por el componente reutilizable
    <app-table-simple> para "Ligas como comisionado" y "Mis equipos".
  - Se mantiene el encabezado con datos básicos del usuario.
  - Reutilizamos loading y error existentes.
-->

<!-- Loading -->
<div class="fp-loading" *ngIf="loading()">
  <mat-spinner></mat-spinner>
</div>

<!-- Error -->
<mat-card *ngIf="!loading() && error()">
  <mat-card-content class="error-box">
    <mat-icon>error</mat-icon>
    <div>{{ error() }}</div>
    <button mat-stroked-button color="primary" (click)="load()">Reintentar</button>
  </mat-card-content>
</mat-card>

<!-- Content -->
<ng-container *ngIf="!loading() && !error() && profile() as p">

  <!-- Header básico -->
  <mat-card class="fp-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>account_circle</mat-icon>
        <span>Mi perfil</span>
      </mat-card-title>
      <mat-card-subtitle>
        {{ p.Email }} · Creado: {{ p.CreatedAt | date:'medium' }}
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div class="fp-grid">
        <div class="row">
          <div class="label">Nombre</div>
          <div class="value">{{ p.Name }}</div>
        </div>
        <div class="row">
          <div class="label">Alias</div>
          <div class="value">{{ p.Alias }}</div>
        </div>
        <div class="row">
          <div class="label">Idioma</div>
          <div class="value">{{ p.LanguageCode }}</div>
        </div>
        <div class="row">
          <div class="label">Estado de cuenta</div>
          <div class="value">{{ p.AccountStatus }}</div>
        </div>
        <div class="row">
          <div class="label">Actualizado</div>
          <div class="value">{{ p.UpdatedAt | date:'medium' }}</div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Ligas como comisionado (usa TableSimple) -->
  <mat-card class="fp-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>emoji_events</mat-icon>
        <span>Ligas como comisionado</span>
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <app-table-simple
        [data]="p.CommissionedLeagues || []"
        [columns]="commissionedColumns"
        [emptyMessage]="'No figuras como comisionado en ninguna liga.'"
        [trackBy]="trackByLeague">
      </app-table-simple>
    </mat-card-content>
  </mat-card>

  <!-- Mis equipos (usa TableSimple) -->
  <mat-card class="fp-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>groups</mat-icon>
        <span>Mis equipos</span>
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <app-table-simple
        [data]="p.Teams || []"
        [columns]="teamsColumns"
        [emptyMessage]="'Aún no tienes equipos asociados.'"
        [trackBy]="trackByTeam">
      </app-table-simple>
    </mat-card-content>
  </mat-card>

  <div class="fp-actions">
    <button mat-stroked-button (click)="load()">
      <mat-icon>refresh</mat-icon> Recargar
    </button>
  </div>
</ng-container>
